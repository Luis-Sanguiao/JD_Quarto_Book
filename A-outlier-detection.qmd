# Outlier detection and Intervention variables {.unnumbered}

Under construction.

## Overview

- External regressors and their use 

- 2 types of external regressors
equations on allocation to components

    - calendar
very specific issue, specific chapter 
    - others : outliers,...
    
Here construction of variables for quarterly and monthly data 
quid about HF ? bilan Ã  faire 


in R once a regressor is defined, it can be used as an external regressor: more possibilities of allocation and fixing coeffs


JDemetra+ provides outlier detection routines which can be used stand alone or as part of a seasonal adjustment process. They can be accessed via GUI or R packages.

## In this chapter 

- generation 

- plug in into algos : in relevant chapters : key = allocation to components ?
automatic or not ?
specify for each type

- detection 



## Generating regressors for outliers

### Available types of outiers

if smth else needed (intervention variables or ramps)
pull out from R doc + Sa chapter 
- names 
- equations 
- explanations 

## Generating regressors for outliers

use cases 
allocation to components: pre-defined in the type, not user customizable

### Generation in GUI
regressors are notre really generated but pre-specified 
v2 calendar (fixing coefficients impossible ?)

V3 calendar or different window, allowing to fix coefficients

### Generation in R 
v2
regressors couldn't be generated but directly implemented in spec 
link to SA chap 

v3 
outliers can be directly implemented in a spec 
link to SA chap

but regressors can also be generated with rjd3toolkit(link to R pack chap) for an independent use

```{r,eval=FALSE}
#Outliers in February 2002
ao <- ao_variable(12, c(2000,1), length = 12*4, date = "2002-02-01")
ls <- ls_variable(12, c(2000,1), length = 12*4, date = "2002-02-01")
tc <- tc_variable(12, c(2000,1), length = 12*4, date = "2002-02-01")
so <- so_variable(12, c(2000,1), length = 12*4, date = "2002-02-01")

```
More details rjd3toolkit help (how to set a link) pages and vignette 

### adding outliers to specification 

### in GUI 

### in R

v2

V3
pb : add outlier and set outlier 

## Generating ramp regressors 

why ? what is different from outliers (and i variables )
how can they be allocated 
dans GUI ramp se voir dans reg_t, pas de choix d'allocation
voir si idem en r

can coefficient be fixed
in GUI separated window

### Generation in GUI 
v2 calendar (fixing coefficients impossible ?)

V3 calendar or different window, allowing to fix coefficients

### Generation in R 
v2
regressors couldn't be generated but directly implemented in spec 
link to SA chap 

v3 
outliers can be directly implemented in a spec 
link to SA chap

but regressors can also be generated with rjd3toolkit for an independent use

```{r,eval=FALSE}
# Ramp variable from January 2001 to September 2001
rp <- ramp_variable(12, c(2000,1), length = 12*4, range = c(13, 21))
# Or equivalently
rp<-ramp_variable(12, c(2000,1), length = 12*4, range = c("2001-01-01", "2001-09-02"))
plot.ts(rp)

```
More details rjd3toolkit help (how to set a link) pages and vignette 

### adding ramps to specification 

### in GUI 

### in R

v2

V3

## Generating intervention variable

why ? what is different from outliers (and ramps)
how can they be allocated 
details in component very important cf JP 

dans GUI intervention va dans reg_i


can coefficient be fixes
je ne comprends pas fenetre dans GUI 

### Generation in GUI 
v2 calendar (fixing coefficients impossible ?)

V3 calendar or different window, allowing to fix coefficients

### Generation in R 
v2
regressors couldn't be generated but directly implemented in spec 
link to SA chap 

v3 
outliers can be directly implemented in a spec 
link to SA chap

but regressors can also be generated with rjd3toolkit for an independent use

```{r,eval=FALSE}

iv<-intervention_variable(frequency=12, start=c(2000, 1), length=60,
                      starts = "2001-01-01", ends = "2001-12-01")
iv
plot(iv)

iv<-intervention_variable(12, c(2000, 1), 60,
                      starts = "2001-01-01", ends = "2001-12-01", delta = 1)
iv
plot(iv)

iv<-intervention_variable(12, c(2000, 1), 60,
                          starts = "2001-01-01", ends = "2001-12-01",
                          delta =0, seasonaldelta=1)
iv
plot(iv)
```
More details rjd3toolkit help (how to set a link) pages and vignette 


### adding intervention variable to specification 

### in GUI 

### in R

v2

V3

## Generating periodic dummies and contrasts

why ? use case ?

in GUI not possible 

### In R

dummies :as many time series as type of periods in a year (4,12)
periodic contrasts; objectif
```{r, eval= FALSE}
## periodic dummies : add explanations and examples
p<-periodic.dummies(4, c(2000,1), 60)
head(p)
class(p)
q<-periodic.contrasts(4, c(2000,1), 60) # erreur to be checked ?
q[1:9,]
```

contrasts
```{r, eval= FALSE}

```

## Generating trigonometric variables 

use case: stable seaso
in what kind of model ?
allocation 
fixed coeff 
in GUI not possible (different algo)

### in R

```{r,eval=FALSE}


```
More details rjd3toolkit help (how to set a link) pages and vignette 

## adding user defined variables to specification
- allocation to component 
- coefficient 

## Outlier detection Parameters in a SA processing

cf function set outlier


## Outlier Detection With Reg Arima models

here we are talking detection outside of an SA process 

### In R 

independent function in 

- rjd3x13 

```{r,eval=FALSE, echo=TRUE}
regarima_outliers(rjd3toolkit::ABS$X0.2.09.10.M, order=c(1,1,1), seasonal=c(0,1,1), 
                  mean=F,
                  X=NULL, X.td=NULL, 
                  ao=T, ls=F, tc=T, so=T, cv=4)

```


- rjd3tramoseats

## Specific TERROR tool

## With structural models (BSM)
